<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - Comune di Piacenza RP</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar">
    <div class="nav-container">
        <div class="nav-logo">
            <img src="Place.png" alt="Logo">
            <span>Comune di Piacenza RP</span>
        </div>
        
        <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
            <span></span>
            <span></span>
            <span></span>
        </button>
        
        <ul class="nav-menu" id="navMenu">
            <li><a href="#home">Home</a></li>
            <li><a href="server-discord.html">Server Discord</a></li>
            <li><a href="gruppo-roblox.html">Gruppo Roblox</a></li>
            <li><a href="#roleplay">Roleplay</a></li>
            <li><a href="#fazioni">Fazioni</a></li>
            <li><a href="regolamento.html">Regolamento</a></li>
            <li><a href="segnalazioni.html">Segnalazioni</a></li>
            <li><a href="guide.html">Guide</a></li>
            <li><a href="#eventi">Eventi</a></li>
            <li id="gestioneLink" style="display:none;"><a href="gestione.html" onclick="return checkStaffAccess(event)">Sezione Staff</a></li>
            <li><a href="#contatti">Contatti</a></li>
            <li><a href="esci.html">Esci</a></li>
        </ul>
        
        <button class="logout-btn" onclick="logout()">Logout</button>
    </div>
</nav>

<!-- HERO -->
<section class="hero">
    <div class="hero-content">
        <img src="Place.png" alt="Logo Piacenza" class="hero-logo">
        <h1>Comune di Piacenza Roleplay</h1>
        <h2 id="welcomeMessage">Benvenuto!</h2>
        <p class="hero-description">Vivi un'esperienza di roleplay immersiva ambientata nel Comune di Piacenza</p>
    </div>
</section>

<!-- SEZIONE EVENTI/GUIDE FISSATI -->
<section id="pinnedEventsGuidesSection" style="display:none; background:#fff; padding:40px 20px;">
    <div class="container">
        <div id="pinnedEventsContainer" style="margin-bottom:40px;"></div>
        <div id="pinnedGuidesContainer"></div>
    </div>
</section>

<!-- COSA OFFRIAMO -->
<section class="info-section" id="home">
    <div class="container">
        <h2>Cosa Offriamo</h2>
        
        <div class="cards-grid">
            <div class="card">
                <div class="card-icon">ğŸ›ï¸</div>
                <h3>Roleplay Realistico</h3>
                <p>Un'esperienza di gioco di ruolo basata sulla realtÃ  della cittÃ  di Piacenza</p>
            </div>
            
            <div class="card">
                <div class="card-icon">ğŸ‘®</div>
                <h3>Carriere Disponibili</h3>
                <p>Polizia, Medici, Vigili del Fuoco, Civili e molte altre professioni</p>
            </div>
            
            <div class="card">
                <div class="card-icon">ğŸ­</div>
                <h3>Eventi Settimanali</h3>
                <p>Eventi organizzati dallo staff per rendere l'esperienza piÃ¹ coinvolgente</p>
            </div>
            
            <div class="card">
                <div class="card-icon">ğŸ¤</div>
                <h3>ComunitÃ  Attiva</h3>
                <p>Una community friendly sempre pronta ad accogliere nuovi membri</p>
            </div>
        </div>
        
        <div id="staff" class="staff-section" style="display:none;">
            <h2>Pannello Amministratore</h2>
            <div class="admin-panel">
                <h3>Benvenuto nello Staff Panel</h3>
                <p class="admin-welcome">Statistiche in tempo reale:</p>
                
                <div class="admin-tools">
                    <div class="tool-card">
                        <h4>ğŸ‘¥ Utenti Totali</h4>
                        <p id="totalUsers">0</p>
                    </div>
                    <div class="tool-card">
                        <h4>ğŸŸ¢ Utenti Online</h4>
                        <p id="onlineUsers">0</p>
                    </div>
                    <div class="tool-card">
                        <h4>ğŸ‘‘ Admin Online</h4>
                        <p id="adminOnline">0</p>
                    </div>
                </div>
                
                <div id="quickActionsContent"></div>
                
                <div class="admin-notice">
                    â„¹ï¸ Accesso riservato allo staff. Le modifiche sono registrate.
                </div>
            </div>
        </div>
    </div>
</section>

<!-- SEZIONE EVENTI IN PROGRAMMA -->
<section class="section" id="eventi">
    <div class="container">
        <h2>ğŸ‰ Eventi in Programma</h2>
        <p style="text-align:center; color:#666; margin-bottom:30px;">Partecipa ai nostri eventi esclusivi!</p>
        <div id="eventsContainer"></div>
    </div>
</section>

<!-- SEZIONE GUIDE -->
<section class="section">
    <div class="container">
        <h2>ğŸ“š Guide Ufficiali</h2>
        <p style="text-align:center; color:#666; margin-bottom:30px;">Scopri come iniziare a giocare!</p>
        <div id="guidesContainer"></div>
    </div>
</section>

<!-- FOOTER -->
<footer class="footer">
    <div class="container">
        <p>&copy; 2026 Comune di Piacenza RP. Tutti i diritti riservati.</p>
    </div>
</footer>

<!-- PULSANTI FLOATING -->
<div id="createEventsGuidesButtons" class="create-floating-buttons" style="display:none;">
    <button class="create-floating-btn event-btn" onclick="openEventGuideModal('evento')">
        ğŸ‰ Crea Evento
    </button>
    <button class="create-floating-btn guide-btn" onclick="openEventGuideModal('guida')">
        ğŸ“š Crea Guida
    </button>
</div>

<!-- MODALE CREAZIONE -->
<div id="eventGuideModal" class="event-guide-modal-overlay">
    <div class="event-guide-modal-box">
        <button class="modal-close-btn" onclick="closeEventGuideModal()">âœ•</button>
        
        <div class="modal-header-section">
            <h2 id="modalHeaderTitle">ğŸ‰ Crea Nuovo Evento</h2>
            <p id="modalHeaderSubtitle">Compila i campi e pubblica su Discord</p>
        </div>

        <form id="eventGuideForm" onsubmit="return false;">
            <input type="hidden" id="eventGuideType" value="evento">
            
            <div class="form-field">
                <label for="eventGuideTitolo">ğŸ“ Titolo *</label>
                <input type="text" id="eventGuideTitolo" placeholder="Es: Grande Evento di Natale!" required maxlength="100">
            </div>

            <div class="form-field">
                <label for="eventGuideDescrizione">ğŸ“„ Descrizione *</label>
                <textarea id="eventGuideDescrizione" placeholder="Descrivi in dettaglio..." required maxlength="2000" rows="6"></textarea>
            </div>

            <div class="form-field" id="dataEventoField">
                <label for="eventGuideData">ğŸ“… Data e Ora Evento *</label>
                <input type="datetime-local" id="eventGuideData">
            </div>

            <div class="form-field">
                <label for="eventGuideImmagine">ğŸ–¼ï¸ URL Immagine (opzionale)</label>
                <input type="url" id="eventGuideImmagine" placeholder="https://esempio.com/immagine.png">
            </div>

            <div class="form-field">
                <label>ğŸ”” Ping Discord</label>
                <div class="ping-options-grid">
                    <label class="ping-option-label">
                        <input type="radio" name="ping" value="none" checked>
                        <span>âŒ Nessun Ping</span>
                    </label>
                    <label class="ping-option-label">
                        <input type="radio" name="ping" value="everyone">
                        <span>ğŸ‘¥ @everyone</span>
                    </label>
                    <label class="ping-option-label">
                        <input type="radio" name="ping" value="here">
                        <span>ğŸŸ¢ @here</span>
                    </label>
                    <label class="ping-option-label">
                        <input type="radio" name="ping" value="both">
                        <span>ğŸ”¥ Entrambi</span>
                    </label>
                </div>
            </div>

            <button type="submit" class="modal-submit-button" id="submitEventGuideBtn">ğŸš€ Pubblica Evento</button>
        </form>
    </div>
</div>

<!-- MODALE DETTAGLI -->
<div id="detailsModal" class="details-modal-overlay">
    <div class="details-modal-content">
        <span class="details-modal-close" onclick="closeDetailsModal()">&times;</span>
        <div id="detailsModalBody"></div>
    </div>
</div>

<!-- CUSTOM ALERT -->
<div id="customAlert" class="custom-alert-overlay">
    <div class="custom-alert-box">
        <div class="alert-icon-wrapper">
            <div class="alert-icon" id="alertIcon">âš ï¸</div>
        </div>
        <h2 class="alert-title" id="alertTitle">Attenzione</h2>
        <p class="alert-message" id="alertMessage">Messaggio</p>
        <p class="alert-date" id="alertDate"></p>
        <button class="alert-btn" onclick="closeCustomAlert()">OK</button>
    </div>
</div>

<!-- MODALE ACCESS DENIED -->
<div id="accessDeniedModal" class="access-modal">
    <div class="access-modal-content">
        <div class="access-modal-icon">ğŸ”’</div>
        <h3>Accesso Negato</h3>
        <p>Non hai i permessi necessari per accedere a questa sezione.</p>
        <button class="modal-ok-btn" onclick="closeAccessModal()">OK</button>
    </div>
</div>

<!-- SCRIPT INLINE BLOCCO SUBMIT (PRIORITÃ€ MASSIMA) -->
<script>
console.log('ğŸ”§ [FIX] Script blocco submit caricato');

function setupFormBlocker() {
    const form = document.getElementById('eventGuideForm');
    if (!form) {
        console.log('âš ï¸ [FIX] Form non trovato, riprovo tra 100ms...');
        setTimeout(setupFormBlocker, 100);
        return;
    }
    
    console.log('âœ… [FIX] Form trovato!');
    
    // BLOCCO 1: onsubmit
    form.onsubmit = function(e) {
        if (e) {
            e.preventDefault();
            e.stopPropagation();
        }
        console.log('ğŸ›‘ [FIX] Submit bloccato da onsubmit!');
        return false;
    };
    
    // BLOCCO 2: addEventListener capture phase
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        e.stopPropagation();
        e.stopImmediatePropagation();
        console.log('ğŸ›‘ [FIX] Submit bloccato da listener (capture)!');
        return false;
    }, true);
    
    console.log('âœ… [FIX] Blocco submit attivo!');
}

// Esegui SUBITO
setupFormBlocker();

// E quando DOM Ã¨ pronto
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', setupFormBlocker);
} else {
    setupFormBlocker();
}
</script>

<!-- CARICA home.js -->
<script src="home.js"></script>

</body>
</html>