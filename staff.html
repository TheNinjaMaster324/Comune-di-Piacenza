<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pannello Staff - Comune di Piacenza RP</title>
    <link rel="stylesheet" href="staff.css">
</head>
<body>
    
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="/Piace.png" alt="Logo" onerror="this.style.display='none';">
                <span>Comune di Piacenza RP</span>
            </div>
            
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <ul class="nav-menu" id="navMenu">
                <li><a href="home.html">Home</a></li>
                <li><a href="staff.html" class="active">Pannello Staff</a></li>
                <li><button class="logout-btn" onclick="logout()">Esci</button></li>
            </ul>
        </div>
    </nav>
    
    <div class="container">
        <div class="header">
            <h1>ğŸ”’ Pannello Amministrazione</h1>
            <p>Benvenuto, <strong id="adminName">Admin</strong></p>
        </div>
        
        <div class="tabs">
            <div class="tab active" onclick="showTab('dashboard')">ğŸ“Š Dashboard</div>
            <div class="tab" onclick="showTab('users')">ğŸ‘¥ Gestione Utenti</div>
            <div class="tab" onclick="showTab('reports')">ğŸš¨ Segnalazioni</div>
            <div class="tab" onclick="showTab('announcements')">ğŸ“¢ Annunci</div>
            <div class="tab" onclick="showTab('logs')">ğŸ“‹ Log AttivitÃ </div>
            <div class="tab" onclick="showTab('settings')">âš™ï¸ Impostazioni</div>
            <div class="tab" onclick="showTab('export')">ğŸ’¾ Backup & Export</div>
        </div>

        <!-- DASHBOARD -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="icon">ğŸ‘¥</span>
                    <h3>Utenti Registrati</h3>
                    <div class="value" id="totalUsers">0</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);">
                    <span class="icon">ğŸš«</span>
                    <h3>Utenti Segnalati</h3>
                    <div class="value" id="bannedUsers">0</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);">
                    <span class="icon">ğŸš¨</span>
                    <h3>Segnalazioni Aperte</h3>
                    <div class="value" id="totalReports">0</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #27ae60 0%, #229954 100%);">
                    <span class="icon">ğŸ“Š</span>
                    <h3>Segnalazioni Totali</h3>
                    <div class="value" id="totalApplications">0</div>
                </div>
            </div>

            <div class="card">
                <h2>ğŸ“ˆ AttivitÃ  Recente</h2>
                <div id="recentActivity">
                    <p style="color: #888;">Caricamento attivitÃ ...</p>
                </div>
            </div>
        </div>

        <!-- SEGNALAZIONI -->
        <div id="reports" class="tab-content">
            <div class="card">
                <h2>ğŸš¨ Segnalazioni Utenti</h2>
                
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterReports('all')">Tutte</button>
                    <button class="filter-btn" onclick="filterReports('pending')">â³ Da Gestire</button>
                    <button class="filter-btn" onclick="filterReports('in_progress')">ğŸ”“ Aperte</button>
                    <button class="filter-btn" onclick="filterReports('resolved')">âœ… Chiuse</button>
                    <button class="filter-btn" onclick="filterReports('archived')">ğŸ“ Archiviate</button>
                </div>

                <div id="reportsList">
                    <p style="color: #888;">Nessuna segnalazione presente.</p>
                </div>
            </div>
        </div>

        <!-- GESTIONE UTENTI -->
        <div id="users" class="tab-content">
            <div class="card">
                <h2>ğŸ‘¥ Gestione Utenti</h2>
                
                <div class="search-box">
                    <input type="text" id="userSearch" placeholder="ğŸ” Cerca utente per username o email..." onkeyup="filterUsers()">
                </div>

                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterByStatus('all')">Tutti</button>
                    <button class="filter-btn" onclick="filterByStatus('active')">âœ… Attivi</button>
                    <button class="filter-btn" onclick="filterByStatus('reported')">ğŸš¨ Segnalati</button>
                    <button class="filter-btn" onclick="filterByStatus('banned')">ğŸš« Bannati</button>
                </div>

                <table class="user-table" id="userTable">
                    <thead>
                        <tr>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Stato</th>
                            <th>Data Registrazione</th>
                            <th>Segnalazioni</th>
                            <th>Azioni</th>
                        </tr>
                    </thead>
                    <tbody id="userTableBody">
                        <!-- Popolato da JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ANNUNCI -->
        <div id="announcements" class="tab-content">
            <div class="card">
                <h2>ğŸ“¢ Crea Nuovo Annuncio</h2>
                <form id="announcementForm">
                    <div class="input-group">
                        <label>Titolo Annuncio</label>
                        <input type="text" id="announcementTitle" required>
                    </div>
                    <div class="input-group">
                        <label>Messaggio</label>
                        <textarea id="announcementMessage" rows="6" required></textarea>
                    </div>
                    <div class="input-group">
                        <label>Tipo</label>
                        <select id="announcementType">
                            <option value="info">â„¹ï¸ Informazione</option>
                            <option value="warning">âš ï¸ Avviso</option>
                            <option value="event">ğŸ‰ Evento</option>
                            <option value="update">ğŸ”„ Aggiornamento</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">ğŸ“¤ Pubblica Annuncio</button>
                </form>
            </div>

            <div class="card">
                <h2>ğŸ“‹ Annunci Pubblicati</h2>
                <div id="announcementsList"></div>
            </div>
        </div>

        <!-- LOG ATTIVITÃ€ -->
        <div id="logs" class="tab-content">
            <div class="card">
                <h2>ğŸ“‹ Log AttivitÃ </h2>
                <div id="logsList"></div>
            </div>
        </div>

        <!-- IMPOSTAZIONI -->
        <div id="settings" class="tab-content">
            <div class="card">
                <h2>âš™ï¸ Impostazioni Globali</h2>
                <form id="settingsForm">
                    <div class="input-group">
                        <label>Nome Server</label>
                        <input type="text" id="serverName" value="Comune di Piacenza RP">
                    </div>
                    <div class="input-group">
                        <label>Email Supporto</label>
                        <input type="email" id="supportEmail" value="piacenzarp@gmail.com">
                    </div>
                    <div class="input-group">
                        <label>Webhook Discord Globale</label>
                        <input type="url" id="globalWebhook" placeholder="https://discord.com/api/webhooks/...">
                    </div>
                    <div class="input-group">
                        <label>Webhook Privato Staff</label>
                        <input type="url" id="staffWebhook" placeholder="https://discord.com/api/webhooks/...">
                    </div>
                    <div class="input-group">
                        <label>Messaggio di Benvenuto</label>
                        <textarea id="welcomeMessage" rows="4">Benvenuto su Comune di Piacenza Roleplay!</textarea>
                    </div>
                    <button type="submit" class="btn btn-success">ğŸ’¾ Salva Impostazioni</button>
                </form>
            </div>
        </div>

        <!-- BACKUP & EXPORT -->
        <div id="export" class="tab-content">
            <div class="card">
                <h2>ğŸ’¾ Backup & Export Dati</h2>
                <p style="color: #666; margin-bottom: 20px;">Scarica i dati del sistema in vari formati</p>
                
                <button class="btn btn-primary" onclick="exportUsers()">ğŸ“¥ Export Utenti (JSON)</button>
                <button class="btn btn-primary" onclick="exportUsersCSV()">ğŸ“Š Export Utenti (CSV)</button>
                <button class="btn btn-primary" onclick="exportAllData()">ğŸ’¾ Backup Completo</button>
                <button class="btn btn-danger" onclick="clearAllData()" style="margin-left: 20px;">ğŸ—‘ï¸ Reset Dati (ATTENZIONE!)</button>
            </div>
        </div>
    </div>

    <script src="staff.js"></script>
</body>
</html>